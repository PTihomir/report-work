webpackJsonp([1],{173:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(179),l=n(r),s=a(2),i=n(s),u=a(1),o=n(u),d=a(3),f=n(d),h=a(5),c=n(h),p=a(4),m=n(p),v=a(0),y=n(v);a(172);var k=a(177),g=n(k),_={checking:"checking",down:"down",ok:"ok"},b=a(37).checkBEMProps,E=function(e){function t(e){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return a.state={settingsHash:0,historyHash:0,messagesHash:0,serverStatus:_.checking},a.handleSendEntries=a.handleSendEntries.bind(a),a}return(0,m.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchStatus(),this.interval=setInterval(function(){e.fetchStatus(!0)},5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"fetchStatus",value:function(e){var t=this,a=this.state,n=a.settingsHash,r=a.historyHash,l=a.messagesHash;fetch("http://localhost:3111/app/status?settings="+n+"&history="+r+"&messages="+l,{method:"POST",headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){var a={serverUnreachable:!1,serverStatus:_.ok};e.settings&&(a.settingsHash=e.settingsHash,a.defaultMailto=e.settings.defaultMailto,a.lastDate=e.settings.lastDate,a.documentUrl=e.settings.documentUrl),e.history&&(a.historyHash=e.historyHash,a.entries=e.history),e.messages&&(a.messagesHash=e.messagesHash,a.messages=e.messages),t.setState(a)}).catch(function(e){console.error(e),t.setState({serverUnreachable:!0,serverStatus:_.down})})}},{key:"handleSendEntries",value:function(e){var t=this;fetch("http://localhost:3111/app/report",{method:"POST",headers:{"Content-Type":"application/json"},body:(0,l.default)(e)}).then(function(e){return e.json()}).then(function(e){t.setState({serverStatus:_.ok}),console.log(e)}).catch(function(e){t.setState({serverStatus:_.down}),console.error(e)})}},{key:"render",value:function(){var e=this.state,t=e.documentUrl,a=e.defaultMailto,n=e.lastDate,r=e.entries,l=e.serverStatus,s=e.messages;return b(y.default,g.default,{defaultMailto:a,documentUrl:t,entries:r,lastDate:n,onSendEntries:this.handleSendEntries,messages:s,serverStatus:l})}}]),t}(v.Component);t.default=E},174:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),l=n(r),s=a(1),i=n(s),u=a(3),o=n(u),d=a(5),f=n(d),h=a(4),c=n(h);a(232);var p=a(0),m=n(p),v=a(278),y=n(v),k=a(37).checkBEMProps,g=k(m.default,"div",null,"Previous reports"),_=function(e){function t(){return(0,i.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props.entries,t=e.filter(function(e){return"string"==typeof e.task}).map(function(e){return k(m.default,"div",{block:"report-list",elem:"line",key:e.date},k(m.default,"div",{block:"report-list",elem:"times"},k(m.default,"div",{block:"report-list",elem:"date"},e.date),k(m.default,"div",{block:"report-list",elem:"hour"},e.hour," h")),k(m.default,"div",{block:"report-list",elem:"tasks"},e.task.split(";").map(function(e,t){return k(m.default,y.default,{key:t,className:"report-list__task",style:{margin:2}},e)})))});return k(m.default,"div",{block:"report-list"},k(m.default,"div",{block:"report-list",elem:"line",mods:{header:!0}},g),t)}}]),t}(p.Component);_.defaultProps={entries:[]},t.default=_},175:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),l=n(r),s=a(1),i=n(s),u=a(3),o=n(u),d=a(5),f=n(d),h=a(4),c=n(h);a(233);var p=a(0),m=n(p),v=a(289),y=n(v),k=a(92),g=n(k),_=a(93),b=n(_),E=a(325),S=n(E),M=a(37).checkBEMProps,C=function(e){function t(e){(0,i.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return console.log(e),a.handleChange=a.handleChange.bind(a),a.handleRemove=a.handleRemove.bind(a),a}return(0,c.default)(t,e),(0,o.default)(t,[{key:"handleChange",value:function(e,t){var a={id:this.props.id,date:this.props.date,hour:this.props.hour,task:this.props.task};null===e&&t?a.date=t:"hour"===e.target.name?a.hour=parseInt(e.target.value):"task"===e.target.name&&(a.task=e.target.value),this.props.onChange(a)}},{key:"handleRemove",value:function(e){this.props.onRemove(this.props.id)}},{key:"render",value:function(){return M(m.default,"div",{block:"report-form-line"},M(m.default,y.default,{style:{marginRight:10},textFieldStyle:{width:100},name:"date",autoOk:!0,value:this.props.date,onChange:this.handleChange,firstDayOfWeek:1}),M(m.default,b.default,{type:"number",style:{width:50,marginRight:10},name:"hour",min:"0",max:"18",size:"2",placeholder:"8",value:this.props.hour,onChange:this.handleChange}),M(m.default,b.default,{type:"text",name:"task",placeholder:"Define tasks",onChange:this.handleChange}),M(m.default,g.default,{onClick:this.handleRemove},M(m.default,S.default,{style:{color:"#CC8888"}})))}}]),t}(p.PureComponent);t.default=C},176:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(10),l=n(r),s=a(118),i=n(s),u=a(63),o=n(u),d=a(78),f=n(d),h=a(180),c=n(h),p=a(2),m=n(p),v=a(1),y=n(v),k=a(3),g=n(k),_=a(5),b=n(_),E=a(4),S=n(E);a(234);var M=a(0),C=n(M),D=a(142),P=n(D),w=a(92),N=n(w),H=a(93),R=n(H),O=a(326),j=n(O),x=a(295),I=n(x),U=a(324),Y=n(U),B=a(175),T=n(B),W=a(37).checkBEMProps,z=W(C.default,"span",{block:"report-form",elem:"title"},"New entries"),A=W(C.default,j.default,null),L=W(C.default,Y.default,null),V=function(e){function t(e){(0,y.default)(this,t);var a=(0,b.default)(this,(t.__proto__||(0,m.default)(t)).call(this,e));return a.state={index:0,entries:[]},a.handleEntryChange=a.handleEntryChange.bind(a),a.handleRemoveEntry=a.handleRemoveEntry.bind(a),a.handleNewEntry=a.handleNewEntry.bind(a),a.handleSending=a.handleSending.bind(a),a.refEmailInput=a.refEmailInput.bind(a),a}return(0,S.default)(t,e),(0,g.default)(t,[{key:"componentWillMount",value:function(){this.handleNewEntry()}},{key:"validateEntry",value:function(e){return(0,c.default)(e.hour)||!e.task||0===e.task.trim().length?e.error=!0:e.error&&delete e.error,e}},{key:"handleEntryChange",value:function(e){var t=this,a=this.state.entries.map(function(a){return a.id===e.id?t.validateEntry((0,f.default)({},a,e)):a});this.setState({entries:a})}},{key:"handleRemoveEntry",value:function(e){var t=this.state.entries.map(function(t){if(t.id!==e)return t}).filter(function(e){return void 0!==e});this.setState({entries:t})}},{key:"handleNewEntry",value:function(){var e=this.state.entries,t=this.state.index+1,a=e.length&&e[e.length-1].date,n=a?(0,P.default)(a).add(1,"d").toDate():this.props.lastDate,r={id:t,date:n,hour:8,task:void 0,onChange:this.handleEntryChange,onRemove:this.handleRemoveEntry};this.setState({index:t,entries:[].concat((0,o.default)(this.state.entries),[r])})}},{key:"handleSending",value:function(){if(!this.state.entries.map(this.validateEntry).some(function(e){return e.error})){var e={};this.state.entries.map(function(e){return{date:(0,P.default)(e.date).format("MM/DD/YYYY"),hour:e.hour,task:e.task.split(";")}}).forEach(function(t){e[t.date]=t});var t=(0,i.default)(e).map(function(t){return e[t]});this.props.onSend({mailTo:this.email.getValue(),entries:t})}}},{key:"refEmailInput",value:function(e){this.email=e}},{key:"render",value:function(){var e=this.props.defaultMailto;return W(C.default,"form",{block:"report-form"},W(C.default,"div",{block:"report-form",elem:"line",mods:{header:!0}},z,W(C.default,N.default,{onClick:this.handleSending,disabled:this.state.entries.map(this.validateEntry).some(function(e){return e.error}),tooltip:"Send"},A)),W(C.default,"div",{block:"report-form",elem:"line",mods:{email:!0}},W(C.default,R.default,{name:"email",type:"email",defaultValue:e,ref:this.refEmailInput,placeholder:"mail:to"}),W(C.default,I.default,{className:"new-button",onClick:this.handleNewEntry},L)),this.state.entries.filter(function(e){return e.date}).map(function(e){return W(C.default,T.default,(0,l.default)({},e,{mix:{block:"report-form",elem:"line"},key:e.id}))}))}}]),t}(M.Component);t.default=V},177:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),l=n(r),s=a(1),i=n(s),u=a(3),o=n(u),d=a(5),f=n(d),h=a(4),c=n(h);a(235);var p=a(0),m=n(p);a(172);var v=a(142),y=n(v),k=a(317),g=n(k),_=a(405),b=n(_),E=a(138),S=n(E),M=a(323),C=n(M),D=a(42),P=n(D),w=a(174),N=n(w),H=a(176),R=n(H);(0,b.default)();var O=a(37).checkBEMProps,j=O(m.default,C.default,null),x=function(e){function t(){return(0,i.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.documentUrl,a=e.defaultMailto,n=e.lastDate,r=e.entries,l=e.serverStatus,s=e.messages,i=e.onSendEntries;return O(m.default,g.default,null,O(m.default,"div",{className:"root"},O(m.default,"div",{className:"root__main"},O(m.default,"div",{className:"root__left-pane"},r&&O(m.default,N.default,{isLoading:!1,entries:r})),O(m.default,"div",{className:"root__right-pane"},n&&a?O(m.default,R.default,{lastDate:(0,y.default)(n,"MM/DD/YYYY").add(1,"day").toDate(),defaultMailto:a,onSend:i}):null)),O(m.default,"div",{className:"root__stats"},t&&O(m.default,S.default,{href:t,target:"_blank",label:"Open spreadsheet",secondary:!0,icon:j}),O(m.default,P.default,{zDepth:2,style:{padding:10,textAlign:"center",display:"inline-block"},className:"root__server-stats root__server-stats--"+l},O(m.default,"ul",{style:{padding:0}},s&&s.map(function(e,t){var a=e.message,n=e.tstamp;return O(m.default,"li",{key:t,style:{display:"block",textAlign:"left"}},(0,y.default)(n).format("LTS"),": ",a)}))))))}}]),t}(p.Component);t.default=x},178:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(0),l=n(r),s=a(18),i=n(s),u=a(173),o=n(u),d=document.getElementById("root"),f=a(37).checkBEMProps,h=f(l.default,o.default,null),c=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.default.render(h,d)};c()},232:function(e,t){},233:function(e,t){},234:function(e,t){},235:function(e,t){}},[178]);